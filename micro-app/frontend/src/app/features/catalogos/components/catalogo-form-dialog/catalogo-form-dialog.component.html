<h2 mat-dialog-title>
  <mat-icon class="dialog-icon">{{ data.config.icono }}</mat-icon>
  {{ isEditMode ? 'Editar' : 'Nuevo' }} {{ data.config.tituloDialogo }}
</h2>

<mat-dialog-content>
  <form [formGroup]="form" class="form-container">
    <!-- Campo Código -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Código</mat-label>
      <input
        matInput
        formControlName="codigo"
        placeholder="Ej: EST001"
        maxlength="50"
        [disabled]="isSaving()"
      />
      <mat-icon matPrefix>tag</mat-icon>
      <mat-hint align="start">Código único identificador</mat-hint>
      @if (hasError('codigo')) {
        <mat-error>{{ getErrorMessage('codigo') }}</mat-error>
      }
    </mat-form-field>

    <!-- Campo Nombre -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nombre</mat-label>
      <input
        matInput
        formControlName="nombre"
        placeholder="Nombre descriptivo"
        maxlength="100"
        [disabled]="isSaving()"
      />
      <mat-icon matPrefix>label</mat-icon>
      <mat-hint align="end">
        {{ form.get('nombre')?.value?.length || 0 }} / 100
      </mat-hint>
      @if (hasError('nombre')) {
        <mat-error>{{ getErrorMessage('nombre') }}</mat-error>
      }
    </mat-form-field>

    <!-- Campo Descripción -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Descripción</mat-label>
      <textarea
        matInput
        formControlName="descripcion"
        placeholder="Descripción opcional"
        maxlength="500"
        rows="3"
        [disabled]="isSaving()"
      ></textarea>
      <mat-icon matPrefix>description</mat-icon>
      <mat-hint align="end">
        {{ form.get('descripcion')?.value?.length || 0 }} / 500
      </mat-hint>
      @if (hasError('descripcion')) {
        <mat-error>{{ getErrorMessage('descripcion') }}</mat-error>
      }
    </mat-form-field>

    <!-- Campo Orden -->
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Orden</mat-label>
      <input
        matInput
        type="number"
        formControlName="orden"
        placeholder="Orden de visualización (opcional)"
        min="0"
        max="9999"
        [disabled]="isSaving()"
      />
      <mat-icon matPrefix>sort</mat-icon>
      <mat-hint>Define el orden de visualización en listas</mat-hint>
      @if (hasError('orden')) {
        <mat-error>{{ getErrorMessage('orden') }}</mat-error>
      }
    </mat-form-field>

    <!-- Campo Activo -->
    <div class="toggle-container">
      <mat-slide-toggle formControlName="activo" [disabled]="isSaving()" color="primary">
        <div class="toggle-label">
          <mat-icon>
            {{ form.get('activo')?.value ? 'check_circle' : 'cancel' }}
          </mat-icon>
          <span>
            {{ form.get('activo')?.value ? 'Activo' : 'Inactivo' }}
          </span>
        </div>
      </mat-slide-toggle>
      <mat-hint class="toggle-hint">
        Los registros inactivos no estarán disponibles en el sistema
      </mat-hint>
    </div>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="cancel()" [disabled]="isSaving()">
    <mat-icon>close</mat-icon>
    Cancelar
  </button>
  <button
    mat-raised-button
    color="primary"
    (click)="save()"
    [disabled]="form.invalid || isSaving()"
  >
    @if (isSaving()) {
      <mat-spinner diameter="20"></mat-spinner>
      <span>Guardando...</span>
    } @else {
      <mat-icon>save</mat-icon>
      <span>Guardar</span>
    }
  </button>
</mat-dialog-actions>
